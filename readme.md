# 유튜브 노래방 개선판

## 소개
예전에 개발했던 [유튜브 노래방](https://github.com/jason8098/yt_karaoke) 의 단점을 보완한 버젼입니다.
이번에는 베이스 언어로 node.js 와 express.js 를 사용했습니다.

## 개선/추가된 점들
- 정보전송은 websocket (socket.io) 를 사용했습니다. 기존에는 일반 POST 방식을 썼었는데 서버와 클라이언트 동기화가 별로 효율적이지 못했고, 간혹 불안정 해져서 바꾸게 되었습니다.
- 기존에는 일부 영상들이 저작권 관련 문제 때문에 제대로 재생되지 않는 문제가 있어 yt-dlp 라이브러리를 활용해 영상 스트림 url 자체를 받아오는 방식으로 설계 되었습니다.
- 또한 개인 설정창을 만들어 사용자가 선호하는 언어, 지역 등을 설정 할 수 있습니다.
- 이전 버전에서는 한 체널에서만 영상을 받아왔다면, 이번엔 지역 설정 (한국, 해외, 자동)을 통해 다양한 체널에서 받아오게끔 만들었습니다.
- 구글이 기본 제공하는 유튜브 검색 api 의 일일 한계치 때문에 여러명이 검색 요청을 보낸다면, 금방 한계치에 도달해버려서 더이상 검색이 안되는 문제가 있었습니다. 다행이 yt-search 라는 써드파티 라이브러리를 통해서 해결 됬습니다. 그러므로 따로 API 키를 발급받는 복잡한 과정을 거치지 않아도 됩니다.

## 아직 부족한 점 / 해결할 점
- 일단 크롬은 자동재생이 안되기에 여전히 파이어폭스를 사용해야 합니다. video-js 라는 라이브러리를 쓰면 된다고 하나, 복잡해서 나중에 다시 시도해볼 예정입니다.
- yt-search 라이브러리가 국가에 따라서 검색결과가 제한된거나 바뀝니다. 국가에 상관없이 동일한 결과를 얻을수 있는 라이브러리가 있으면 한번 시도해 보겠습니다.
- yt-dlp 의 고질병? 같은게 최근에 생겼습니다. 유튜브 로그인이 되어있지 않으면 스트림 url을 얻을수 없습니다. 그러므로 브라우저에서 쿠키를 추출해서 명령줄에 --cookies 또는 --cookies-from-browser 를 사용해 넣어줘야 합니다. 하지만이게 또 기기마다 다르고, 윈도우에서는 제대로 작동이 안되고, 일부 브라우저만 제대로 된다는 점에서 좀 불안정하지 않나 싶습니다. 이것도 대체가능한 라이브러리가 필요합니다. 

## 설치
### 준비물
우선 node.js, git 그리고 python이 필요합니다.

그리고 아래 명렁어를 이용해 yt-dlp 를 설치합니다.

`pip install yt-dlp`

## 스크린샷
업로드 예정